C51 COMPILER V9.54   XFS5152V2                                                             04/30/2020 01:44:05 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE XFS5152V2
OBJECT MODULE PLACED IN XFS5152V2.OBJ
COMPILER INVOKED BY: D:\MDK\C51\BIN\C51.EXE XFS5152V2.c LARGE OPTIMIZE(8,SPEED) BROWSE MODP2 DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*****************************************************************
   2          **  ƣYS-XFS5152ϳ׳
   3          **  ˵ûʹóʱֻҪд ڷͺPrintCom()ɣ
   4                   ֱӵñļвżɣڱдʱעжϳģ
   5                   ķֵݷֵһβţ粻շֵ޷
   6                   һβš
   7          /*******************************************************************/
   8          
   9          #include "XFS5152V2.h"
  10          #include "uart.h"
  11          
  12          /**************оƬ*********************/
  13          code uchar XFS_StopCom[]= {0xFD,0X00,0X01,0X02}; //ֹͣϳ
  14          code uchar XFS_SuspendCom[]= {0XFD,0X00,0X01,0X03}; //ͣϳ
  15          code uchar XFS_RecoverCom[]= {0XFD,0X00,0X01,0X04}; //ָϳ
  16          code uchar XFS_ChackCom[]= {0XFD,0X00,0X01,0X21}; //״̬ѯ
  17          code uchar XFS_PowerDownCom[]= {0XFD,0X00,0X01,0X88}; //POWER DOWN ״̬
  18          
  19          /***********************************************/
  20          
  21          //趨
  22          code uchar YSpeed[11][6] = {"[s0]","[s1]","[s2]","[s3]","[s4]","[s5]","[s6]","[s7]","[s8]","[s9]","[s10]"}
             -;//ٵ
  23          code uchar YTone[11][6] = {"[t0]","[t1]","[t2]","[t3]","[t4]","[t5]","[t6]","[t7]","[t8]","[t9]","[t10]"};
             -//
  24          code uchar YVolume[11][6] = {"[v0]","[v1]","[v2]","[v3]","[v4]","[v5]","[v6]","[v7]","[v8]","[v9]","[v10]"
             -};//
  25          code uchar YPeople[6][6] = {"[m3]","[m51]","[m52]","[m53]","[m54]","[m55]"};//
  26          
  27          static uchar YS = 5;//ָ 0-10
  28          static uchar YT = 5;//ָ 0-10
  29          static uchar YV = 8;//ָ 0-10
  30          static uchar YP = 1;//ָ 0-5
  31          
  32          /***********************************************************
  33          *     ƣ  Strlen
  34          *     ܣ  ַ
  35          * ڲ  *DAT:ıָ
  36          * ڲ    
  37          * ˵    
  38          **********************************************************/
  39          unsigned short Strlen(uchar *DAT)
  40          {
  41   1          unsigned short length;
  42   1          for( length = 0; *DAT++ ; length++ );
  43   1          return length;
  44   1      }
  45          
  46          /***********************************************************
  47          *     ƣ  Strcpy
  48          *     ܣ  
  49          * ڲ  *info  *data:ıָ
  50          * ڲ    void
  51          * ˵    
  52          **********************************************************/
C51 COMPILER V9.54   XFS5152V2                                                             04/30/2020 01:44:05 PAGE 2   

  53          void Strcpy(uchar *info,uchar *dat)
  54          {
  55   1          while( *dat )
  56   1          {
  57   2              *info++ = *dat++;
  58   2          }
  59   1          *info = 0;
  60   1      }
*** WARNING C231 IN LINE 60 OF XFS5152V2.c: '_Strcpy': attempt to redefine intrinsic function
  61          
  62          
  63          /***********************************************************
  64          *     ƣ  YS-XFS5152 ıϳɺ
  65          *     ܣ  ͺϳıXFS5152оƬкϳɲ
  66          * ڲ  *data:ıָ
  67          * ڲ
  68          * ˵     ֻıϳɣ߱ѡĬϲ
  69                      Ϊ115200bps(ﲻ) 
  70                      Frame_Info[500]Ϊ500  һԷ͵
  71                      ϢֽΪ450ڡ
  72          * ÷ SYN_FrameInfo
  73          **********************************************************/
  74          void XFS_FrameInfo(uchar *dat)
  75          {
  76   1          /****************Ҫ͵ı**********************************/
  77   1          unsigned  char Frame_Info[500]= {1,1,1,1,1}; //ı ǰһҪΪ0洮ʱ㴮
             -Ҫ
  78   1          unsigned  short length;
  79   1          unsigned  short pos;
  80   1          unsigned  short temp;
  81   1      
  82   1          //ַ
  83   1          temp = 5;
  84   1          Strcpy(&Frame_Info[temp],YSpeed[YS]); //Ϣм
  85   1          temp = Strlen(Frame_Info);
  86   1          Strcpy(&Frame_Info[temp],YTone[YT]);  //Ϣм
  87   1          temp = Strlen(Frame_Info);
  88   1          Strcpy(&Frame_Info[temp],YVolume[YV]);  //Ϣм
  89   1          temp = Strlen(Frame_Info);
  90   1          Strcpy(&Frame_Info[temp],YPeople[YP]);  //Ϣм뷢
  91   1          temp = Strlen(Frame_Info);
  92   1      
  93   1          length = Strlen(dat);       //Ҫıĳ
  94   1          length = length+temp-3;               //ܳ
  95   1          /*****************̶֡Ϣ**************************************/
  96   1          Frame_Info[0] = 0xFD ;      //֡ͷFD
  97   1          Frame_Info[1] = length>>8 ;   //ȵĸֽ
  98   1          Frame_Info[2] = length%256;       //ȵĵֽ
  99   1          Frame_Info[3] = 0x01 ;      //֣ϳɲ
 100   1          Frame_Info[4] = GBK;       //ıʽGBK
 101   1      
 102   1          /*******************֡Ϣ***************************************/
 103   1          Strcpy(&Frame_Info[temp],dat);
 104   1          for( pos = 0 ; pos<length+3 ; pos++ )
 105   1          {
 106   2              XFS_PutChar(Frame_Info[pos]);//ôڷ ļconfigXFS_PutCharָ˿ڷ
 107   2          }
 108   1      
 109   1      }
 110          
 111          /***********************************************************
 112          *     ƣ  YSOrder ִк
C51 COMPILER V9.54   XFS5152V2                                                             04/30/2020 01:44:05 PAGE 3   

 113          *     ܣ  Լ
 114          * ڲ  orderΪ  Χ0x00-0x07
 115          * ڲ
 116          * ˵    
 117          * ÷ мʱִ
 118          **********************************************************/
 119          void YSOrder(unsigned char order)//
 120          {
 121   1          unsigned  char temp[20];
 122   1          unsigned  char num[3];
 123   1          unsigned  short length;
 124   1          switch( order )
 125   1          {
 126   2          case 0x01:
 127   2              YS = (YS+1)%11;//ټӿ
 128   2              break;
 129   2          case 0x02:
 130   2              YS = (YS+11-1)%11;//ټ
 131   2              break;
 132   2          case 0x03:
 133   2              YT = (YT+1)%11;//
 134   2              break;
 135   2          case 0x04:
 136   2              YT = (YT+11-1)%11;//
 137   2              break;
 138   2          case 0x05:
 139   2              YV = (YV+1)%11;//
 140   2              break;
 141   2          case 0x06:
 142   2              YV = (YV+11-1)%11;//
 143   2              break;
 144   2          case 0x07:
 145   2              YP = (YP+1)%6;//һ
 146   2              XFS_FrameInfo("ڵ");
 147   2              break;
 148   2          case 0x08://ָĬֵ
 149   2              YS = 5;//ָ 0-10
 150   2              YT = 5;//ָ 0-10
 151   2              YV = 5;//ָ 0-10
 152   2              YP = 1;//ָ 0-5
 153   2              XFS_FrameInfo("ѻָĬ");
 154   2              break;
 155   2          default:
 156   2              break;
 157   2          }
 158   1          if( order == 0x01 || order == 0x02 )
 159   1          {
 160   2              if( YS == 10 )
 161   2              {
 162   3                  num[0] = 49;
 163   3                  num[1] = 48;
 164   3                  num[2] = 0;
 165   3              }
 166   2              else
 167   2              {
 168   3                  num[0] = YS+48;
 169   3                  num[1] = 0;
 170   3              }
 171   2              Strcpy(temp,"ѵ");
 172   2              length = Strlen(temp);
 173   2              Strcpy(&temp[length],num);
 174   2              length = Strlen(temp);
C51 COMPILER V9.54   XFS5152V2                                                             04/30/2020 01:44:05 PAGE 4   

 175   2              Strcpy(&temp[length],"");
 176   2              XFS_FrameInfo(temp);
 177   2          }
 178   1          else if( order == 0x03 || order == 0x04 )
 179   1          {
 180   2              if( YT == 10 )
 181   2              {
 182   3                  num[0] = 49;
 183   3                  num[1] = 48;
 184   3                  num[2] = 0;
 185   3              }
 186   2              else
 187   2              {
 188   3                  num[0] = YT+48;
 189   3                  num[1] = 0;
 190   3              }
 191   2              Strcpy(temp,"ѵ");
 192   2              length = Strlen(temp);
 193   2              Strcpy(&temp[length],num);
 194   2              length = Strlen(temp);
 195   2              Strcpy(&temp[length],"");
 196   2              XFS_FrameInfo(temp);
 197   2          }
 198   1          else if( order == 0x05 || order == 0x06 )
 199   1          {
 200   2      
 201   2              if( YV == 10 )
 202   2              {
 203   3                  num[0] = 49;
 204   3                  num[1] = 48;
 205   3                  num[2] = 0;
 206   3              }
 207   2              else
 208   2              {
 209   3                  num[0] = YV+48;
 210   3                  num[1] = 0;
 211   3              }
 212   2              Strcpy(temp,"ѵ");
 213   2              length = Strlen(temp);
 214   2              Strcpy(&temp[length],num);
 215   2              length = Strlen(temp);
 216   2              Strcpy(&temp[length],"");
 217   2              XFS_FrameInfo(temp);
 218   2          }
 219   1      }
 220          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    954    ----
   CONSTANT SIZE    =    830    ----
   XDATA SIZE       =      4     544
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
